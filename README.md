This is the updated SAS macro with the improvement to address the issues of many empty cell, a real data example was given in the program. 

The program was developed to support the conference paper 
https://www.researchgate.net/publication/266043388_SAS_Global_Forum_2008_Statistics_and_Data_Analysis_Paper_382-2008_Generalized_McNemar%27s_Test_for_Homogeneity_of_the_Marginal_Distributions
